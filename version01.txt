After bug fixing, this is the new feature with minor alteration
